# vibe-coding-docs 工作流程

## 场景 1: 初始校验（无修改时）

当用户在没有进行任何修改的情况下调用 skill：

### 步骤
1. **询问用户**是否需要校验文档与项目的一致性
   ```
   在进行文档管理之前，建议先校验文档与实际项目进度的一致性。
   是否需要进行文档校验？
   ```

2. 如果用户同意，执行校验：
   - 读取 `docs/plan/plan.md` 获取当前版本和已实现内容
   - 检查项目代码，验证已实现内容是否真实完成
   - 检查 `docs/archive/` 和 `docs/technical/` 是否有对应版本目录
   - 生成校验报告

3. 根据校验结果：
   - 如果一致：告知用户文档状态良好
   - 如果不一致：列出差异，询问是否需要修正

## 场景 2: 更新文档（已完成修改后）

当用户已完成代码修改，需要更新文档时：

### 步骤

#### 2.1 确定版本号
- 询问用户当前版本号（如 v1.0.1），默认为在plan版本的基础上增加
- 如果版本目录不存在，创建 `docs/archive/v{VERSION}/` 和 `docs/technical/v{VERSION}/`

#### 2.2 收集变更信息
通过以下方式收集：
- 查看 git diff 或 git status
- 询问用户本次修改的内容和目的
- 了解修改的影响范围

#### 2.3 更新 plan.md
1. **更新版本号**：修改"当前版本"
2. **更新已实现内容**：将新完成的功能从"待实现"移至"已实现"
3. **调整待实现内容**：根据实际情况增删
4. **更新日期**：修改"最后更新"

#### 2.4 创建 archive 文档
1. 在 `docs/archive/v{VERSION}/` 创建 `YYYY-MM-DD-变更记录.md`
2. 记录变更内容、影响范围、相关文件
3. 如果进行了测试，创建测试记录文档

#### 2.5 创建 technical 文档（如需要）
如果修改涉及技术细节、Bug修复或架构变更：
1. 在 `docs/technical/v{VERSION}/` 创建 `YYYY-MM-DD-{标题}.md`
2. 记录问题描述、解决方案、关键代码
3. 包含流程图或架构图（使用 mermaid）

#### 2.6 检查文档长度
- 如果 plan.md 超过 200 行，考虑将详细规划拆分到子文档
- 如果 archive/technical 文档超过 300 行，拆分为多个专题文档
- 使用相对路径引用子文档

#### 2.7 更新 CLAUDE.md
1. 定位到项目文档章节
2. 更新当前版本信息
3. 添加新创建文档的链接和概要
4. 确保快速导航准确反映文档结构

## 场景 3: 查询文档

当用户需要查看或了解文档状态时：

### 步骤
1. 读取 `docs/plan/plan.md` 获取项目概况
2. 根据用户需求，读取对应的 archive 或 technical 文档
3. 提供结构化的摘要信息

## 文档整洁性检查

### plan.md 检查清单
- [ ] 版本信息清晰
- [ ] 已实现和待实现内容分类明确
- [ ] 避免冗长的描述，保持简洁
- [ ] 使用列表而非段落
- [ ] 相关文档使用链接引用

### archive/technical 文档检查清单
- [ ] 标题包含日期和版本
- [ ] 内容结构化，使用标题和列表
- [ ] 代码块使用语法高亮
- [ ] 长文档拆分为多个子文档
- [ ] 使用 mermaid 图表辅助说明（可选）

## 常见操作

### 创建版本目录
```bash
mkdir -p docs/archive/v1.0
mkdir -p docs/technical/v1.0
```

### 使用模板
从 `assets/` 目录复制模板：
- `plan_template.md` → `docs/plan/plan.md`
- `archive_template.md` → `docs/archive/v{VERSION}/YYYY-MM-DD-{title}.md`
- `technical_template.md` → `docs/technical/v{VERSION}/YYYY-MM-DD-{title}.md`

### 更新文档索引
编辑项目根目录的 `CLAUDE.md`，在文档章节添加或更新链接。
